<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=0, minimum-scale=1, maximum-scale=5">
    <title>중앙스테이 콘텐츠</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="icon" type="image/png" href="https://team-nexusway.github.io/jungang/assets/image/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="https://team-nexusway.github.io/jungang/assets/image/favicon.svg" />
    <link rel="shortcut icon" href="https://team-nexusway.github.io/jungang/assets/image/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="https://team-nexusway.github.io/jungang/assets/image/apple-touch-icon.png" />
    <link rel="preconnect" href="https://cdn.jsdelivr.net" />
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
    <link href="https://cdn.jsdelivr.net/gh/toss/tossface/dist/tossface.css" rel="stylesheet" type="text/css" />
    <style>
        .tossface {
          font-family: Tossface;
          font-size: 1.3rem;
        }
      </style>

    <!-- PWA 설정 -->
    <link rel="manifest" href="manifest.json">

    <!-- iOS에서 전체 화면 표시 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="중앙고 스테이 모바일">

    <link href="Jungang-content.css" rel="stylesheet" type="text/css"/>
</head>
<body>

    <h1>ㅤ</h1><br><h2>ㅤ</h2>

<body class="!bg-[#101012] text-white">
    <div class="max-w-sm mx-auto bg-gray-900 min-h-screen p-4">
 <!-- 헤더 -->
 <div class="flex justify-between items-center mb-6">
    <div class="flex items-center space-x-3">
        <img src="https://team-nexusway.github.io/jungang/assets/image/jungang-main_logo.png" alt="중앙중 로고" class="w-10 h-10 rounded-full">
        <span class="text-[#D9D9D9] text-lg font-semibold tracking-wide">군산중앙고 스테이</span>
    </div>
    <div class="flex space-x-4">
        <!-- 학생이름 표시 -->
        <span id="welcomeUser" class="bg-[#363740] text-[#BFBFBF] px-4 py-2 rounded-lg">
            로딩 중...
        </span>        
    </div>
</div>
<script>
(function() {
    try {
        let loggedInUser = localStorage.getItem("loggedInUser");

        if (!loggedInUser) {
            window.location.replace("https://team-nexusway.github.io/jungang/login");
        } else {
            // ✅ sessionStorage에도 로그인 정보 복구 (새로고침해도 유지)
            sessionStorage.setItem("loggedInUser", loggedInUser);

            document.getElementById("welcomeUser").innerText = `${loggedInUser}님`;
        }
    } catch (error) {
        console.error("로그인 확인 중 오류 발생:", error);
        window.location.replace("https://team-nexusway.github.io/jungang/login");
    }
})();

</script>







<script>
    // 화면의 너비가 1024px 이상이면 PC로 간주하고 리다이렉트
    if (window.innerWidth >= 1024) {
      window.location.href = "https://team-nexusway.github.io/jungang/pc.html";
    }
  </script>

</body>
</head>


<body>
<div class="bg-[#23232a] p-8 rounded-2xl shadow-2xl w-full max-w-md text-center">
  <div class="flex justify-center mb-6">
    <div class="w-10 h-10 border-4 border-blue-400 border-t-transparent rounded-full animate-spin"></div>
  </div>
  <h1 class="text-xl md:text-2xl font-bold mb-3">
    미니게임 페이지로 이동중!
  </h1>
  <p class="text-[#B0B0B0] text-base mb-6">
    <span id="countdown" class="font-semibold text-blue-400">3</span>초 후에 자동으로 이동합니다.<br/>
    이동하지 않으면 <a href="https://team-nexusway.github.io/jungang/" class="text-blue-400 hover:text-blue-500 no-underline">여기를 클릭</a>하세요.
  </p>
  <p class="text-sm text-[#666]">Team NexusWay</p>
</div>

  <script>
    let countdown = 3;
    const countdownEl = document.getElementById("countdown");

    const interval = setInterval(() => {
      countdown--;
      countdownEl.textContent = countdown;
      if (countdown <= 0) {
        clearInterval(interval);
        window.location.href = "https://zanusn.github.io/Ascend";
      }
    }, 1000);
  </script>
      </body>



    <script>
        // 서비스 워커 등록
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js').then(registration => {
                console.log('✅ Service Worker 등록 성공:', registration.scope);

                // 업데이트가 있을 때 처리
                registration.onupdatefound = () => {
                    const newWorker = registration.installing;
                    console.log('🚀 새 서비스 워커 감지됨!');

                    // 새 워커 상태가 'installed'일 때
                    newWorker.onstatechange = () => {
                        if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                            console.log('🔄 새로운 업데이트가 있습니다!');

                            // 📢 사용자에게 알림 표시
                            alert('새로운 업데이트가 있습니다! 페이지를 새로 고침하세요.');

                            // 새로운 서비스 워커 즉시 활성화
                            newWorker.postMessage({ type: 'skipWaiting' });

                            // 페이지 자동 새로 고침
                            window.location.reload();
                        }
                    };
                };
            }).catch(error => {
                console.log('❌ Service Worker 등록 실패:', error);
            });

            // 서비스 워커 컨트롤러가 변경될 때 페이지 새로고침
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                console.log('🔄 서비스 워커가 새로 고침됨!');
                window.location.reload();
            });
        }
    </script>



<script>
  let idleTimer;
  let isUserActive = true;

  // 강력 새로 고침 함수 (캐시 무시)
  function forceReload() {
    console.log("10초간 활동 없음 → 강력 새로고침");
    location.reload(true); // true는 캐시 무시 (단, 일부 브라우저는 무시함)
    // 보장하려면 아래처럼 query 파라미터로 우회하는 방법도 있음
    // location.href = location.pathname + '?reload=' + new Date().getTime();
  }

  // 사용자 활동 감지 함수
  function resetIdleTimer() {
    if (!isUserActive) {
      console.log("사용자 활동 감지됨. 타이머 초기화");
    }
    isUserActive = true;
    clearTimeout(idleTimer);
    idleTimer = setTimeout(() => {
      isUserActive = false;

      // 현재 창이 **열려 있고**, 사용자 입력이 없었다면 새로고침
      if (document.visibilityState === 'visible') {
        forceReload();
      }
    }, 10000); // 10초
  }

  // 사용자 활동 이벤트 바인딩
  ['mousemove', 'scroll', 'keydown', 'click', 'touchstart'].forEach(event => {
    window.addEventListener(event, resetIdleTimer, { passive: true });
  });

  // 페이지가 처음 로드될 때 타이머 시작
  resetIdleTimer();

  // 탭이 백그라운드로 전환되었다가 돌아올 때 다시 체크
  document.addEventListener("visibilitychange", () => {
    if (document.visibilityState === 'visible') {
      resetIdleTimer();
    }
  });
</script>



</div>
</body>
</html>

